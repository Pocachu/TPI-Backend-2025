FROM icr.io/appcafe/open-liberty:full-java17-openj9-ubi

# Copiar el driver de PostgreSQL
COPY --chown=1001:0 postgresql-42.6.0.jar /opt/ol/wlp/usr/shared/resources/

# Copiar el archivo server.xml
COPY --chown=1001:0 src/main/liberty/config/server.xml /config/

# Copiar el archivo de aplicaci贸n WAR
COPY --chown=1001:0 target/*.war /config/apps/

# Configuraci贸n de variables de entorno
ENV DB_SERVER=postgres
ENV DB_PORT=5432
ENV DB_NAME=tipicos
ENV DB_USER=postgres
ENV DB_PASSWORD=postgres

# Configuraci贸n del servidor para pruebas de salud
HEALTHCHECK --interval=5s --timeout=3s CMD curl -f http://localhost:9080/health || exit 1

# Puerto para la aplicaci贸n
EXPOSE 9080 9443
